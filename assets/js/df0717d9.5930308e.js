"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[824],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>h});var s=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,s,n=function(e,t){if(null==e)return{};var a,s,n={},r=Object.keys(e);for(s=0;s<r.length;s++)a=r[s],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(s=0;s<r.length;s++)a=r[s],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=s.createContext({}),u=function(e){var t=s.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},c=function(e){var t=u(e.components);return s.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return s.createElement(s.Fragment,{},t)}},p=s.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),p=u(a),h=n,f=p["".concat(l,".").concat(h)]||p[h]||d[h]||r;return a?s.createElement(f,i(i({ref:t},c),{},{components:a})):s.createElement(f,i({ref:t},c))}));function h(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,i=new Array(r);i[0]=p;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:n,i[1]=o;for(var u=2;u<r;u++)i[u]=a[u];return s.createElement.apply(null,i)}return s.createElement.apply(null,a)}p.displayName="MDXCreateElement"},2765:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>u});var s=a(7462),n=(a(7294),a(3905));const r={id:"dte-guide",title:"Distributed Task Execution Guide",type:"explainer"},i="Distributed Task Execution Guide",o={unversionedId:"concepts/dte-guide",id:"concepts/dte-guide",title:"Distributed Task Execution Guide",description:"The illustrations in this guide are created by Nrwlian Nicole Oliver",source:"@site/docs/concepts/dte-guide.md",sourceDirName:"concepts",slug:"/concepts/dte-guide",permalink:"/docs/concepts/dte-guide",draft:!1,editUrl:"https://github.com/lerna/lerna/tree/main/website/docs/concepts/dte-guide.md",tags:[],version:"current",frontMatter:{id:"dte-guide",title:"Distributed Task Execution Guide",type:"explainer"},sidebar:"main",previous:{title:"How Caching Works",permalink:"/docs/concepts/how-caching-works"},next:{title:"Using pnpm with Lerna",permalink:"/docs/recipes/using-pnpm-with-lerna"}},l={},u=[{value:"What&#39;s a Task?",id:"whats-a-task",level:2},{value:"Nx Cloud Schedules Your CI Tasks Automatically",id:"nx-cloud-schedules-your-ci-tasks-automatically",level:2},{value:"Nx Cloud Efficiently Orchestrates Agents",id:"nx-cloud-efficiently-orchestrates-agents",level:2},{value:"Task Execution Order Matters",id:"task-execution-order-matters",level:2},{value:"Why Distribute Tasks?",id:"why-distribute-tasks",level:2},{value:"What Does It Cost?",id:"what-does-it-cost",level:2},{value:"Security",id:"security",level:2},{value:"Example",id:"example",level:2},{value:"Illustration",id:"illustration",level:2}],c={toc:u};function d(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,s.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"distributed-task-execution-guide"},"Distributed Task Execution Guide"),(0,n.kt)("p",null,"The illustrations in this guide are created by Nrwlian ",(0,n.kt)("a",{parentName:"p",href:"https://twitter.com/nixcodes"},"Nicole Oliver")),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"how does distributed task execution work in Nx Cloud?",src:a(2855).Z,width:"900",height:"343"})),(0,n.kt)("h2",{id:"whats-a-task"},"What's a Task?"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"what&#39;s a task? project + target (i.e. shared-product-ui + test).  each run contains many tasks.  affected:test contains shared-product-ui:test, product-page:test, shared-e2e-util:test and shared-ui:test",src:a(8098).Z,width:"680",height:"508"})),(0,n.kt)("p",null,"A task, from Lerna's perspective, is a target running on a project.  i.e. The target ",(0,n.kt)("inlineCode",{parentName:"p"},"test")," running on the project ",(0,n.kt)("inlineCode",{parentName:"p"},"shared-product-ui")," is a task.  For more information about tasks, see the ",(0,n.kt)("a",{parentName:"p",href:"../features/run-tasks"},"Run Tasks article"),"."),(0,n.kt)("h2",{id:"nx-cloud-schedules-your-ci-tasks-automatically"},"Nx Cloud Schedules Your CI Tasks Automatically"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"when you turn on DTE, Nx will schedule your commands&#39; tasks in CI.  for example, say you want to run these 3 commands to verify your code: nx affected --target=lint, nx affected --target=test and nx affected --target=build",src:a(9086).Z,width:"680",height:"526"})),(0,n.kt)("p",null,"Let's imagine for every PR in CI, you want to lint, test and build all affected projects.  When you write your CI workflow, you have no way of knowing how many projects will be affected by each PR or how long each task will take.  No matter how carefully you set things up, there will be wasted time if you manually assign a static number of agent machines for linting, testing and building.  This approach is called binning."),(0,n.kt)("p",null,"Luckily, with distributed task execution, Nx Cloud can dynamically assign tasks to agents as they become available."),(0,n.kt)("h2",{id:"nx-cloud-efficiently-orchestrates-agents"},"Nx Cloud Efficiently Orchestrates Agents"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Nx will automatically schedule tasks w/agents you assign in CI.",src:a(2319).Z,width:"680",height:"310"})),(0,n.kt)("p",null,"When you set up DTE, you define (1) the tasks that you want to run and (2) the number of agents that are available for Nx Cloud to use.  Then the Nx Cloud orchestrator distributes tasks to agents efficiently - so that all the agents are being fully utilized and your CI process finishes as soon as possible."),(0,n.kt)("h2",{id:"task-execution-order-matters"},"Task Execution Order Matters"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"but don&#39;t some tasks depend on others&#39; results?  Yep! Nx knows about your dependency tree, so it will execute tasks in the right order and make sure the results are available where they&#39;re needed.",src:a(5998).Z,width:"680",height:"557"})),(0,n.kt)("p",null,"There are some tasks that need to be executed before other tasks, but Nx Cloud takes that into account when it assigns tasks to agents.  For a more detailed look at defining those dependencies, read the ",(0,n.kt)("a",{parentName:"p",href:"../features/run-tasks"},"Run Tasks article"),"."),(0,n.kt)("h2",{id:"why-distribute-tasks"},"Why Distribute Tasks?"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Result: Faster Builds!",src:a(6082).Z,width:"680",height:"440"})),(0,n.kt)("p",null,"Efficiently parallelizing your CI process across many agents can dramatically speed up your CI, which helps developers identify problems faster and get more work done."),(0,n.kt)("h2",{id:"what-does-it-cost"},"What Does It Cost?"),(0,n.kt)("p",null,"Nx Cloud is FREE for open source projects.  Contact ",(0,n.kt)("a",{parentName:"p",href:"mailto:cloud-support@nrwl.io"},"cloud-support@nrwl.io")," to get set up."),(0,n.kt)("p",null,"For closed source projects, the first 500 computation hours per month are free.  Most workspaces don't exceed this amount.  No credit card is required.  After 500 hours, the cost is $1 per computation hour."),(0,n.kt)("p",null,"For more details, see the ",(0,n.kt)("a",{parentName:"p",href:"https://nx.app/pricing"},"Nx Cloud pricing page"),"."),(0,n.kt)("h2",{id:"security"},"Security"),(0,n.kt)("p",null,"Your actual code is not stored in the cloud, but the hashed inputs and cached results of your tasks are.  It is possible to enable end to end encryption of that data so that no one can view that information without your key.  Also, if you want to host Nx Cloud on your own servers, you can sign up for Nx Private Cloud."),(0,n.kt)("h2",{id:"example"},"Example"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/vsavkin/lerna-dte"},"This is an example repo")," showing how easy it is to set up distributed task\nexecution, showing the performance gains, and comparing to sharding/binning."),(0,n.kt)("h2",{id:"illustration"},"Illustration"),(0,n.kt)("p",null,"Here is the full illustrated explanation page that ",(0,n.kt)("a",{parentName:"p",href:"https://twitter.com/nixcodes"},"Nicole Oliver")," made:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"How Does DTE Work Explainer",src:a(3342).Z,width:"1668",height:"2388"})))}d.isMDXComponent=!0},6082:(e,t,a)=>{a.d(t,{Z:()=>s});const s=a.p+"assets/images/faster-builds-59a232e5f98a04d44a5e2bc82eaff792.jpeg"},2855:(e,t,a)=>{a.d(t,{Z:()=>s});const s=a.p+"assets/images/how-does-dte-work-577993a1c7e19ef801bc76623f3c58f0.jpeg"},3342:(e,t,a)=>{a.d(t,{Z:()=>s});const s=a.p+"assets/images/nx-cloud-how-does-dte-work-65244729488886b3b40e4072491a3393.png"},9086:(e,t,a)=>{a.d(t,{Z:()=>s});const s=a.p+"assets/images/schedule-tasks-71d06587de8f289c9955a1052051d2de.jpeg"},5998:(e,t,a)=>{a.d(t,{Z:()=>s});const s=a.p+"assets/images/task-dependencies-ba3f69e12b4a12cac2454ce509aa58c3.jpeg"},2319:(e,t,a)=>{a.d(t,{Z:()=>s});const s=a.p+"assets/images/use-agents-d6bc7fdc5c63f4a871171cf0cf63e114.jpeg"},8098:(e,t,a)=>{a.d(t,{Z:()=>s});const s=a.p+"assets/images/whats-a-task-7552def96ccf59b70629c3afe745b61a.jpeg"}}]);