"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[549],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>m});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},l=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),d=p(n),m=i,f=d["".concat(s,".").concat(m)]||d[m]||u[m]||a;return n?r.createElement(f,o(o({ref:t},l),{},{components:n})):r.createElement(f,o({ref:t},l))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,o=new Array(a);o[0]=d;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:i,o[1]=c;for(var p=2;p<a;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},4074:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>c,toc:()=>p});var r=n(7462),i=(n(7294),n(3905));const a={id:"utilities",title:"Utilities",type:"reference"},o="Utilities",c={unversionedId:"api-reference/utilities",id:"api-reference/utilities",title:"Utilities",description:"Lerna ships some utility functions that can be used in creating your own tools within a Lerna monorepo.",source:"@site/docs/api-reference/utilities.md",sourceDirName:"api-reference",slug:"/api-reference/utilities",permalink:"/docs/api-reference/utilities",draft:!1,editUrl:"https://github.com/lerna/lerna/tree/main/website/docs/api-reference/utilities.md",tags:[],version:"current",frontMatter:{id:"utilities",title:"Utilities",type:"reference"},sidebar:"main",previous:{title:"Configuration",permalink:"/docs/api-reference/configuration"},next:{title:"Legacy Package Management",permalink:"/docs/legacy-package-management"}},s={},p=[{value:"<code>detectProjects()</code>",id:"detectprojects",level:2}],l={toc:p};function u(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,r.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"utilities"},"Utilities"),(0,i.kt)("p",null,"Lerna ships some utility functions that can be used in creating your own tools within a Lerna monorepo."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'const utils = require("lerna/utils");\n')),(0,i.kt)("h2",{id:"detectprojects"},(0,i.kt)("inlineCode",{parentName:"h2"},"detectProjects()")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"detectProjects()")," function creates the same project graph file mapping that Lerna uses under the covers to execute its commands. This is useful for writing your own scripts that need to operate on the same set of packages that Lerna would."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'const { detectProjects } = require("lerna/utils");\n\nconst { projectGraph, projectFileMap } = await detectProjects();\n')),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"projectGraph")," that is returned will be a ",(0,i.kt)("inlineCode",{parentName:"p"},"ProjectGraphWithPackages"),", which is an extension of the ",(0,i.kt)("inlineCode",{parentName:"p"},"ProjectGraph")," type from ",(0,i.kt)("inlineCode",{parentName:"p"},"@nx/devkit"),". It contains additional metadata about projects that have ",(0,i.kt)("inlineCode",{parentName:"p"},"package.json")," files. It also has a ",(0,i.kt)("inlineCode",{parentName:"p"},"localPackageDependencies")," property that tracks internal npm dependencies between projects (as opposed to external npm dependencies that are downloaded from the registry)."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"projectFileMap")," is a mapping of project names to the files within them. This is used to determine which project needs to be versioned when a file changes."),(0,i.kt)("p",null,"See ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/lerna/lerna/blob/main/libs/core/src/lib/project-graph-with-packages.ts"},"Lerna's TypeScript source code")," for specific type details."))}u.isMDXComponent=!0}}]);