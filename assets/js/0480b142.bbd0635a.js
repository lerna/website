"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[836],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>u});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),s=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},c=function(e){var t=s(e.components);return n.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),d=s(a),u=r,h=d["".concat(l,".").concat(u)]||d[u]||m[u]||o;return a?n.createElement(h,i(i({ref:t},c),{},{components:a})):n.createElement(h,i({ref:t},c))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=d;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p.mdxType="string"==typeof e?e:r,i[1]=p;for(var s=2;s<o;s++)i[s]=a[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},3584:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>p,toc:()=>s});var n=a(7462),r=(a(7294),a(3905));const o={id:"faq",title:"FAQ",type:"recipe"},i="Frequently asked questions",p={unversionedId:"faq",id:"faq",title:"FAQ",description:"This document is a work in progress.",source:"@site/docs/faq.md",sourceDirName:".",slug:"/faq",permalink:"/docs/faq",draft:!1,editUrl:"https://github.com/lerna/lerna/tree/main/website/docs/faq.md",tags:[],version:"current",frontMatter:{id:"faq",title:"FAQ",type:"recipe"},sidebar:"main",previous:{title:"Legacy Package Management",permalink:"/docs/legacy-package-management"},next:{title:"Lerna 6: Obsolete Options",permalink:"/docs/lerna6-obsolete-options"}},l={},s=[{value:"How do I add a third party dependency to my Lerna repository?",id:"how-do-i-add-a-third-party-dependency-to-my-lerna-repository",level:2},{value:"New packages within the lerna repo",id:"new-packages-within-the-lerna-repo",level:3},{value:"Existing packages",id:"existing-packages",level:3},{value:"How do I retry publishing if <code>publish</code> fails?",id:"how-do-i-retry-publishing-if-publish-fails",level:2},{value:"How does Lerna detect packages?",id:"how-does-lerna-detect-packages",level:2}],c={toc:s};function m(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"frequently-asked-questions"},"Frequently asked questions"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"This document is a work in progress.")),(0,r.kt)("h2",{id:"how-do-i-add-a-third-party-dependency-to-my-lerna-repository"},"How do I add a third party dependency to my Lerna repository?"),(0,r.kt)("p",null,"Lerna is not responsible for adding or linking your dependencies, that is what your package manager of choice (",(0,r.kt)("inlineCode",{parentName:"p"},"npm"),"/",(0,r.kt)("inlineCode",{parentName:"p"},"yarn"),"/",(0,r.kt)("inlineCode",{parentName:"p"},"pnpm"),") is best at. By using the ",(0,r.kt)("inlineCode",{parentName:"p"},"workspaces")," feature of your package manager, all the linking of local packages will happen automatically based on the relationships you set up in your ",(0,r.kt)("inlineCode",{parentName:"p"},"package.json")," files."),(0,r.kt)("p",null,"You can check out the ",(0,r.kt)("inlineCode",{parentName:"p"},"workspaces")," documentation for your package manager here:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"npm")," (",(0,r.kt)("a",{parentName:"li",href:"https://docs.npmjs.com/cli/using-npm/workspaces"},"https://docs.npmjs.com/cli/using-npm/workspaces"),")"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"yarn")," (",(0,r.kt)("a",{parentName:"li",href:"https://yarnpkg.com/features/workspaces"},"https://yarnpkg.com/features/workspaces"),")"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"pnpm")," (",(0,r.kt)("a",{parentName:"li",href:"https://pnpm.io/workspaces"},"https://pnpm.io/workspaces"),")")),(0,r.kt)("p",null,"NOTE: Because lerna itself predates the ",(0,r.kt)("inlineCode",{parentName:"p"},"workspaces")," feature in package managers, there was historically a few commands (",(0,r.kt)("inlineCode",{parentName:"p"},"add"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"bootstrap")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"link"),") that attempted to fill that gap. Fortunately these commands are no longer needed and lerna can focus on what it does best and let the package managers does the same."),(0,r.kt)("h3",{id:"new-packages-within-the-lerna-repo"},"New packages within the lerna repo"),(0,r.kt)("p",null,"You can use the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/lerna/lerna/tree/main/libs/commands/create#readme"},(0,r.kt)("inlineCode",{parentName:"a"},"lerna create"))," command to create new packages within your lerna repo."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"lerna create <packageName>\n")),(0,r.kt)("p",null,"See the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/lerna/lerna/tree/main/libs/commands/create#readme"},"create docs")," for more options."),(0,r.kt)("p",null,"If you don't want to use ",(0,r.kt)("inlineCode",{parentName:"p"},"lerna create"),", then you can still manually create a package by running ",(0,r.kt)("inlineCode",{parentName:"p"},"npm init")," within a subdirectory of the ",(0,r.kt)("inlineCode",{parentName:"p"},"packages")," folder and Lerna will automatically detect it."),(0,r.kt)("h3",{id:"existing-packages"},"Existing packages"),(0,r.kt)("p",null,"You can use ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/lerna/lerna/blob/main/libs/commands/import/README.md"},(0,r.kt)("inlineCode",{parentName:"a"},"lerna import <package>"))," to transfer an existing package\ninto your Lerna repository; this command will preserve the commit history."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/lerna/lerna/blob/main/libs/commands/import/README.md"},(0,r.kt)("inlineCode",{parentName:"a"},"lerna import <package>"))," takes a local path rather than a URL. In this\ncase you will need to have the repo you wish to link to on your file system."),(0,r.kt)("h2",{id:"how-do-i-retry-publishing-if-publish-fails"},"How do I retry publishing if ",(0,r.kt)("inlineCode",{parentName:"h2"},"publish")," fails?"),(0,r.kt)("p",null,"In the case that some packages were successfully published and others were not, lerna publish may have left the repository in an inconsistent state with some changed files. To recover from this, reset any extraneous local changes from the failed run to get back to a clean working tree. Then, retry the same lerna publish command. Lerna will attempt to publish all of the packages again, but will recognize those that have already been published and skip over them with a warning."),(0,r.kt)("p",null,"If you used the lerna publish command without positional arguments to select a new version for the packages, then you can run lerna publish from-git to retry publishing that same already-tagged version instead of having to bump the version again while retrying."),(0,r.kt)("h2",{id:"how-does-lerna-detect-packages"},"How does Lerna detect packages?"),(0,r.kt)("p",null,"By default, for ",(0,r.kt)("inlineCode",{parentName:"p"},"npm")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"yarn"),", lerna uses the configured ",(0,r.kt)("inlineCode",{parentName:"p"},"workspaces")," property in ",(0,r.kt)("inlineCode",{parentName:"p"},"package.json")," to know what packages to operate on. For details on this property, see the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.npmjs.com/cli/using-npm/workspaces"},"npm documentation")," or the ",(0,r.kt)("a",{parentName:"p",href:"https://yarnpkg.com/features/workspaces"},"yarn documentation"),"."),(0,r.kt)("p",null,"If you are using ",(0,r.kt)("inlineCode",{parentName:"p"},"pnpm"),", you might have set ",(0,r.kt)("inlineCode",{parentName:"p"},"npmClient")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"pnpm")," in ",(0,r.kt)("inlineCode",{parentName:"p"},"lerna.json"),". In this case, Lerna will use the ",(0,r.kt)("inlineCode",{parentName:"p"},"packages")," property in ",(0,r.kt)("inlineCode",{parentName:"p"},"pnpm-workspace.yaml")," to know what packages to operate on. For details on this property, see the ",(0,r.kt)("a",{parentName:"p",href:"https://pnpm.io/workspaces"},"pnpm documentation"),"."),(0,r.kt)("p",null,"If you want lerna to focus on a particular subset of packages in your repo, you can leverage the ",(0,r.kt)("inlineCode",{parentName:"p"},"packages")," property in ",(0,r.kt)("inlineCode",{parentName:"p"},"lerna.json")," to search for packages."))}m.isMDXComponent=!0}}]);