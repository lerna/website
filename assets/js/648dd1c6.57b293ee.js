"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[659],{3905:(e,a,t)=>{t.d(a,{Zo:()=>c,kt:()=>u});var n=t(7294);function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function o(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?o(Object(t),!0).forEach((function(a){r(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function l(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)t=o[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=n.createContext({}),p=function(e){var a=n.useContext(s),t=a;return e&&(t="function"==typeof e?e(a):i(i({},a),e)),t},c=function(e){var a=p(e.components);return n.createElement(s.Provider,{value:a},e.children)},m={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},d=n.forwardRef((function(e,a){var t=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(t),u=r,g=d["".concat(s,".").concat(u)]||d[u]||m[u]||o;return t?n.createElement(g,i(i({ref:a},c),{},{components:t})):n.createElement(g,i({ref:a},c))}));function u(e,a){var t=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var o=t.length,i=new Array(o);i[0]=d;var l={};for(var s in a)hasOwnProperty.call(a,s)&&(l[s]=a[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var p=2;p<o;p++)i[p]=t[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,t)}d.displayName="MDXCreateElement"},5959:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var n=t(7462),r=(t(7294),t(3905));const o={id:"legacy-package-management",title:"Legacy Package Management",type:"recipe"},i="Legacy Package Management",l={unversionedId:"features/legacy-package-management",id:"features/legacy-package-management",title:"Legacy Package Management",description:"Background",source:"@site/docs/features/legacy-package-management.md",sourceDirName:"features",slug:"/features/legacy-package-management",permalink:"/docs/features/legacy-package-management",draft:!1,editUrl:"https://github.com/lerna/lerna/tree/main/website/docs/features/legacy-package-management.md",tags:[],version:"current",frontMatter:{id:"legacy-package-management",title:"Legacy Package Management",type:"recipe"},sidebar:"main",previous:{title:"Editor Integrations",permalink:"/docs/features/editor-integrations"},next:{title:"Concepts",permalink:"/docs/concepts"}},s={},p=[{value:"Background",id:"background",level:2},{value:"Legacy Bootstrap Command",id:"legacy-bootstrap-command",level:2},{value:"Other Bootstrapping Methods",id:"other-bootstrapping-methods",level:2}],c={toc:p};function m(e){let{components:a,...t}=e;return(0,r.kt)("wrapper",(0,n.Z)({},c,t,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"legacy-package-management"},"Legacy Package Management"),(0,r.kt)("h2",{id:"background"},"Background"),(0,r.kt)("p",null,'Lerna is the original monorepo/workspace tool in the JavaScript ecosystem. When it was created in 2015/2016 the ecosystem looked totally different, and there were no built in capabilities to handle working with multiple packages in a single repository (a "workspace"). Commands like lerna bootstrap, lerna add and lerna link were all a critical part of the lerna project, because there were no other options.'),(0,r.kt)("p",null,"However, now that we find ourselves in late 2022, the fact is that - for many years now - the package managers we know and love (",(0,r.kt)("inlineCode",{parentName:"p"},"npm"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"yarn")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"pnpm"),") all fully support that concept of workspaces as a first-class use-case."),(0,r.kt)("p",null,"They have battle tested implementations covering adding, removing and linking local packages, and combining them with third party dependencies in a natural way."),(0,r.kt)("p",null,"This is the reason why, for the past several years of his tenure as lead maintainer of Lerna, Daniel, has been encouraging folks to strongly reconsider their use of the legacy package management commands in lerna, and instead leverage their package manager of choice to do what it does best."),(0,r.kt)("p",null,"We knew about this context from afar, but as new stewards of the project we did not want to jump straight in and start removing capabilities without first taking the time to get familiar with the reality up close. Now that we have been actively maintaining the project for half a year, we are in full agreement with Daniel and others that the legacy package management commands in lerna need to be retired."),(0,r.kt)("p",null,"By removing these legacy pieces which have better alternatives natively in package managers, we and the rest of the lerna community will be freed up to concentrate our efforts on things which are uniquely valuable about lerna (such as, but not limited to, versioning and publishing), and making them the best they can be!"),(0,r.kt)("p",null,"From version 7, therefore, we will no longer ship the legacy package management commands (such as lerna bootstrap, lerna add and lerna link) by default with lerna, and instead make them available as an add-on via a separate package (name TBD)."),(0,r.kt)("p",null,"This new package can be thought of as being in maintenance mode only - no new features will be considered for legacy package management concerns (such as lerna bootstrap, lerna add and lerna link), and we will only look to merge critical patches and security updates."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"This same context is covered on the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/lerna/lerna/discussions/3410"},"Lerna v7 discussion"),", if you have any specific concerns, please join us there and provide as much information as possible!")),(0,r.kt)("h2",{id:"legacy-bootstrap-command"},"Legacy Bootstrap Command"),(0,r.kt)("p",null,"Lerna's legacy bootstrap command links different projects within the repo so they can import each other without having to publish anything to NPM. To show how Lerna does it, we will take ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/lerna/getting-started-example"},"this repository")," as an example."),(0,r.kt)("p",null,"The repo contains three packages or projects:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"header")," (a library of React components)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"footer")," (a library of React components)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"remixapp")," (an app written using the Remix framework which depends on both ",(0,r.kt)("inlineCode",{parentName:"li"},"header")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"footer"),")")),(0,r.kt)("p",null,"The Remix app imports the ",(0,r.kt)("inlineCode",{parentName:"p"},"header")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"footer")," libraries as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'jsx title="packages/remixapp/app/routes/index.tsx"',jsx:!0,title:'"packages/remixapp/app/routes/index.tsx"'},'import { Header } from "header";\nimport { Footer } from "footer";\n\nexport default function Index() {\n  return (\n    <>\n      <Header />\n      <div>Content!</div>\n      <Footer />\n    </>\n  );\n}\n')),(0,r.kt)("p",null,"And it depends on them in its ",(0,r.kt)("inlineCode",{parentName:"p"},"package.json")," as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="packages/remixapp/package.json"',title:'"packages/remixapp/package.json"'},'{\n  "dependencies": {\n    "@remix-run/node": "^1.5.1",\n    "@remix-run/react": "^1.5.1",\n    "@remix-run/serve": "^1.5.1",\n    "react": "^17.0.2",\n    "react-dom": "^17.0.2",\n    "header": "*",\n    "footer": "*"\n  }\n}\n')),(0,r.kt)("p",null,"To make the ",(0,r.kt)("inlineCode",{parentName:"p"},"header")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"footer")," available inside the ",(0,r.kt)("inlineCode",{parentName:"p"},"remixapp"),", run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"lerna bootstrap --use-workspaces\n")),(0,r.kt)("p",null,"This installs all the dependencies needed for the 3 projects and links the ",(0,r.kt)("inlineCode",{parentName:"p"},"header")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"footer")," projects so that ",(0,r.kt)("inlineCode",{parentName:"p"},"remixapp")," can reference them like npm packages. ",(0,r.kt)("inlineCode",{parentName:"p"},"--use-workspaces")," tells Lerna to delegate package linking process to your package manager. (This feature is supported by npm, yarn and pnpm.)"),(0,r.kt)("p",null,"You can also set ",(0,r.kt)("inlineCode",{parentName:"p"},"useWorkspaces")," as the default behavior in the ",(0,r.kt)("inlineCode",{parentName:"p"},"lerna.json")," file:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="lerna.json"',title:'"lerna.json"'},'{\n    ...\n    "useWorkspaces": true\n}\n')),(0,r.kt)("h2",{id:"other-bootstrapping-methods"},"Other Bootstrapping Methods"),(0,r.kt)("p",null,"Bootstrapping this way should work for most people, but you can use ",(0,r.kt)("a",{parentName:"p",href:"../concepts/alternate-bootstrapping-methods"},"Alternate Legacy Bootstrapping Methods")," if needed."))}m.isMDXComponent=!0}}]);